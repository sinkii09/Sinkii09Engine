<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sinkii09 Engine - InputService Complete Documentation</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --success-color: #059669;
            --warning-color: #d97706;
            --danger-color: #dc2626;
            --dark-bg: #1f2937;
            --light-bg: #f8fafc;
            --text-primary: #1f2937;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            --code-bg: #f1f5f9;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: var(--light-bg);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .nav {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 20px;
            z-index: 100;
        }

        .nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .nav a {
            color: var(--primary-color);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .nav a:hover {
            background-color: var(--code-bg);
        }

        .section {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: var(--primary-color);
            font-size: 2rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 0.5rem;
        }

        .section h3 {
            color: var(--secondary-color);
            font-size: 1.5rem;
            margin: 1.5rem 0 1rem 0;
        }

        .section h4 {
            color: var(--text-primary);
            font-size: 1.2rem;
            margin: 1rem 0 0.5rem 0;
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            border: 1px solid #3e3e3e;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
        }
        
        .code-block pre {
            margin: 0;
            padding: 1.5rem;
            white-space: pre;
            overflow-x: auto;
        }

        .inline-code {
            background: var(--code-bg);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: monospace;
            font-size: 0.9rem;
        }

        .api-method {
            background: #f8fafc;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .api-method .signature {
            background: var(--dark-bg);
            color: white;
            padding: 1rem;
            border-radius: 4px;
            font-family: monospace;
            margin-bottom: 1rem;
            overflow-x: auto;
        }

        .api-method .description {
            margin-bottom: 1rem;
        }

        .api-method .parameters {
            margin-bottom: 1rem;
        }

        .api-method .returns {
            color: var(--success-color);
            font-weight: bold;
        }

        .status-badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .status-complete { background: var(--success-color); color: white; }
        .status-wip { background: var(--warning-color); color: white; }
        .status-planned { background: var(--text-secondary); color: white; }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .feature-card {
            background: #f8fafc;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
        }

        .feature-card h4 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .architecture-diagram {
            text-align: center;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .diagram-box {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            padding: 1rem 2rem;
            margin: 0.5rem;
            border-radius: 8px;
            font-weight: bold;
        }

        .diagram-arrow {
            display: inline-block;
            color: var(--text-secondary);
            font-size: 1.5rem;
            margin: 0 1rem;
        }

        .examples {
            background: #f0f9ff;
            border-left: 4px solid var(--primary-color);
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .examples h4 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        ul, ol {
            margin: 1rem 0;
            padding-left: 2rem;
        }

        li {
            margin: 0.5rem 0;
        }

        .table-container {
            overflow-x: auto;
            margin: 1rem 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th, td {
            border: 1px solid var(--border-color);
            padding: 1rem;
            text-align: left;
        }

        th {
            background: var(--code-bg);
            font-weight: bold;
            color: var(--primary-color);
        }

        .priority-high { border-left: 4px solid var(--danger-color); }
        .priority-medium { border-left: 4px solid var(--warning-color); }
        .priority-low { border-left: 4px solid var(--success-color); }

        @media (max-width: 768px) {
            .nav ul {
                flex-direction: column;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }

        /* Usage Examples Styling */
        .section-intro {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 2rem;
            font-style: italic;
        }

        .example-container {
            background: #fefefe;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .example-container h3 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 0.5rem;
            font-size: 1.4rem;
        }

        .example-desc {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            font-size: 1rem;
        }

        /* VS Code Dark Theme Syntax Highlighting */
        .code-block .keyword { color: #569cd6; font-weight: bold; }
        .code-block .class-name { color: #4ec9b0; }
        .code-block .interface { color: #b8d7a3; }
        .code-block .method { color: #dcdcaa; }
        .code-block .enum { color: #4fc1ff; }
        .code-block .comment { color: #6a9955; font-style: italic; }
        .code-block .string { color: #ce9178; }
        .code-block .number { color: #b5cea8; }
        .code-block .operator { color: #d4d4d4; }
        .code-block .punctuation { color: #d4d4d4; }
        .code-block .namespace { color: #4ec9b0; }

        .tip-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            border: 1px solid #bbdefb;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .tip-box h4 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 1rem;
        }

        .tip-box li {
            margin-bottom: 0.8rem;
        }

        .tip-box code {
            background: rgba(255,255,255,0.8);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: monospace;
            font-size: 0.85rem;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>🎮 Sinkii09 Engine - InputService</h1>
            <p>Complete Professional Input Management System</p>
            <p><strong>Version:</strong> 2.0.0 | <strong>Last Updated:</strong> January 2025</p>
        </div>
    </div>

    <div class="container">
        <nav class="nav">
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#architecture">Architecture</a></li>
                <li><a href="#context-system">Context System</a></li>
                <li><a href="#api-reference">API Reference</a></li>
                <li><a href="#usage-examples">Usage Examples</a></li>
                <li><a href="#configuration">Configuration</a></li>
                <li><a href="#rebinding">Rebinding System</a></li>
                <li><a href="#advanced">Advanced Features</a></li>
                <li><a href="#migration">Migration Guide</a></li>
            </ul>
        </nav>

        <!-- Overview Section -->
        <section id="overview" class="section">
            <h2>📋 System Overview</h2>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>🎯 Core Features</h4>
                    <span class="status-badge status-complete">Complete</span>
                    <ul>
                        <li>Type-safe input queries</li>
                        <li>Professional context management</li>
                        <li>Device detection & switching</li>
                        <li>Configuration-driven sensitivity</li>
                        <li>Memory leak prevention</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>🔄 Advanced Systems</h4>
                    <span class="status-badge status-complete">Complete</span>
                    <ul>
                        <li>Priority-based input contexts</li>
                        <li>Runtime input rebinding</li>
                        <li>SaveLoadService integration</li>
                        <li>Handle-based lifecycle management</li>
                        <li>Cross-service event coordination</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>🚀 Performance</h4>
                    <span class="status-badge status-complete">Complete</span>
                    <ul>
                        <li>Zero allocation input queries</li>
                        <li>Cached action lookups</li>
                        <li>Efficient context processing</li>
                        <li>Optimized sensitivity curves</li>
                        <li>&lt;16ms input latency</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>♿ Future Features</h4>
                    <span class="status-badge status-planned">Phase 4</span>
                    <ul>
                        <li>Hold-to-press actions</li>
                        <li>Button mashing assistance</li>
                        <li>Sticky keys implementation</li>
                        <li>Accessibility presets</li>
                        <li>WCAG compliance</li>
                    </ul>
                </div>
            </div>

            <h3>Key Improvements Over Legacy System</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Feature</th>
                            <th>Legacy System</th>
                            <th>Modern System</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Context Management</td>
                            <td>Stack-based with magic strings</td>
                            <td>Priority-based with GUID handles</td>
                        </tr>
                        <tr>
                            <td>Input Filtering</td>
                            <td>Boolean block/allow lists</td>
                            <td>Separate PlayerAction/UIAction filters</td>
                        </tr>
                        <tr>
                            <td>Lifecycle</td>
                            <td>Manual string-based cleanup</td>
                            <td>RAII with IDisposable handles</td>
                        </tr>
                        <tr>
                            <td>Persistence</td>
                            <td>PlayerPrefs only</td>
                            <td>SaveLoadService + RuntimeData</td>
                        </tr>
                        <tr>
                            <td>Debugging</td>
                            <td>Limited visibility</td>
                            <td>Stack traces, health monitoring</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Architecture Section -->
        <section id="architecture" class="section">
            <h2>🏗️ System Architecture</h2>

            <div class="architecture-diagram">
                <h3>Component Hierarchy</h3>
                <div>
                    <div class="diagram-box">InputService</div>
                </div>
                <div class="diagram-arrow">↓</div>
                <div>
                    <div class="diagram-box">InputDeviceTracker</div>
                    <div class="diagram-box">InputSensitivityProcessor</div>
                    <div class="diagram-box">InputRebindingManager</div>
                </div>
                <div class="diagram-arrow">↓</div>
                <div>
                    <div class="diagram-box">InputBindingPersistence</div>
                    <div class="diagram-box">Context Management</div>
                </div>
                <div class="diagram-arrow">↓</div>
                <div>
                    <div class="diagram-box">Unity Input System</div>
                    <div class="diagram-box">SaveLoadService</div>
                </div>
            </div>

            <h3>Core Components</h3>

            <div class="api-method">
                <h4>InputService</h4>
                <div class="description">
                    Main service implementing <code class="inline-code">IInputService</code>. Provides all input queries, context management, and coordinates with other engine services.
                </div>
                <p><strong>Responsibilities:</strong></p>
                <ul>
                    <li>Input action queries (IsPressed, GetValue, etc.)</li>
                    <li>Context registration and lifecycle management</li>
                    <li>Device detection and switching</li>
                    <li>Configuration application (sensitivity, curves)</li>
                </ul>
            </div>

            <div class="api-method">
                <h4>InputDeviceTracker</h4>
                <div class="description">
                    Event-based device detection system with automatic switching and cached sensitivity multipliers.
                </div>
                <p><strong>Features:</strong></p>
                <ul>
                    <li>Real-time device change detection</li>
                    <li>Automatic sensitivity application</li>
                    <li>Performance optimized (&lt;0.01ms impact)</li>
                </ul>
            </div>

            <div class="api-method">
                <h4>InputRebindingManager</h4>
                <div class="description">
                    Complete rebinding system with conflict detection, validation, and SaveLoadService integration.
                </div>
                <p><strong>Capabilities:</strong></p>
                <ul>
                    <li>Interactive rebinding with timeout</li>
                    <li>Conflict detection and resolution</li>
                    <li>Multiple bindings per action support</li>
                    <li>Profile management and persistence</li>
                </ul>
            </div>
        </section>

        <!-- Context System Section -->
        <section id="context-system" class="section">
            <h2>🎯 Modern Context System</h2>

            <p>The InputService features a professional-grade context system using <strong>priority-based processing</strong> instead of legacy stack-based blocking.</p>

            <h3>Context Layers</h3>
            <div class="code-block">
<pre><span class="comment">// InputLayer Enum:</span>
<span class="enum">System</span>    <span class="punctuation">(</span><span class="number">500</span><span class="punctuation">)</span> <span class="comment">- Highest priority (pause, dev console)</span>
<span class="enum">Critical</span>  <span class="punctuation">(</span><span class="number">400</span><span class="punctuation">)</span> <span class="comment">- Error dialogs, warnings</span>
<span class="enum">Modal</span>     <span class="punctuation">(</span><span class="number">300</span><span class="punctuation">)</span> <span class="comment">- Dialogs, confirmations</span>
<span class="enum">Menus</span>     <span class="punctuation">(</span><span class="number">200</span><span class="punctuation">)</span> <span class="comment">- Inventory, character sheet</span>
<span class="enum">GameplayUI</span><span class="punctuation">(</span><span class="number">100</span><span class="punctuation">)</span> <span class="comment">- HUD, minimap</span>
<span class="enum">Gameplay</span>  <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">)</span>   <span class="comment">- Base gameplay actions</span></pre>

            <h3>Filter Modes</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Mode</th>
                            <th>Behavior</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>PassThrough</code></td>
                            <td>Allow all actions</td>
                            <td>Default gameplay contexts</td>
                        </tr>
                        <tr>
                            <td><code>AllowOnly</code></td>
                            <td>Whitelist specific actions</td>
                            <td>Tutorials, restricted modes</td>
                        </tr>
                        <tr>
                            <td><code>BlockExcept</code></td>
                            <td>Blacklist with exceptions</td>
                            <td>Dialogs, cutscenes</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="examples">
                <h4>Context Usage Examples</h4>
                <div class="code-block">
<pre><span class="comment">// Dialog Context:</span>
<span class="keyword">var</span> dialogContext <span class="operator">=</span> <span class="class-name">InputContext</span><span class="punctuation">.</span><span class="method">CreateModal</span><span class="punctuation">(</span><span class="enum">UIAction</span><span class="punctuation">.</span>Submit<span class="punctuation">,</span> <span class="enum">UIAction</span><span class="punctuation">.</span>Cancel<span class="punctuation">)</span>
    <span class="punctuation">.</span><span class="method">WithDebugInfo</span><span class="punctuation">(</span><span class="string">"Settings.ConfirmDialog"</span><span class="punctuation">);</span>
    
<span class="keyword">using</span> <span class="keyword">var</span> handle <span class="operator">=</span> inputService<span class="punctuation">.</span><span class="method">RegisterContext</span><span class="punctuation">(</span>dialogContext<span class="punctuation">);</span>
<span class="comment">// Dialog active - only Submit/Cancel work</span>
<span class="comment">// Auto-cleanup when leaving scope</span>

<span class="comment">// Inventory Context:</span>
<span class="keyword">var</span> inventoryContext <span class="operator">=</span> <span class="keyword">new</span> <span class="class-name">InputContext</span><span class="punctuation">(</span><span class="enum">InputLayer</span><span class="punctuation">.</span>Menus<span class="punctuation">)</span>
    <span class="punctuation">.</span><span class="method">WithPlayerFilter</span><span class="punctuation">(</span><span class="class-name">ActionFilter</span><span class="operator">&lt;</span><span class="enum">PlayerAction</span><span class="operator">&gt;</span><span class="punctuation">.</span><span class="method">BlockExcept</span><span class="punctuation">())</span> <span class="comment">// Block all</span>
    <span class="punctuation">.</span><span class="method">WithUIFilter</span><span class="punctuation">(</span><span class="class-name">ActionFilter</span><span class="operator">&lt;</span><span class="enum">UIAction</span><span class="operator">&gt;</span><span class="punctuation">.</span><span class="method">AllowAll</span><span class="punctuation">())</span> <span class="comment">// Allow UI</span>
    <span class="punctuation">.</span><span class="method">WithInputConsumption</span><span class="punctuation">(</span><span class="keyword">true</span><span class="punctuation">);</span>

<span class="comment">// Custom Vehicle Context:</span>
<span class="keyword">var</span> vehicleFilter <span class="operator">=</span> <span class="class-name">ActionFilter</span><span class="operator">&lt;</span><span class="enum">PlayerAction</span><span class="operator">&gt;</span><span class="punctuation">.</span><span class="method">AllowOnly</span><span class="punctuation">(</span>
    <span class="enum">PlayerAction</span><span class="punctuation">.</span>Move<span class="punctuation">,</span>     <span class="comment">// Now controls steering</span>
    <span class="enum">PlayerAction</span><span class="punctuation">.</span>Look<span class="punctuation">,</span>     <span class="comment">// Camera control</span>
    <span class="enum">PlayerAction</span><span class="punctuation">.</span>Attack<span class="punctuation">,</span>   <span class="comment">// Vehicle weapon</span>
    <span class="enum">PlayerAction</span><span class="punctuation">.</span>Interact  <span class="comment">// Exit vehicle</span>
<span class="punctuation">);</span>

<span class="keyword">var</span> vehicleContext <span class="operator">=</span> <span class="keyword">new</span> <span class="class-name">InputContext</span><span class="punctuation">(</span><span class="enum">InputLayer</span><span class="punctuation">.</span>Gameplay<span class="punctuation">)</span>
    <span class="punctuation">.</span><span class="method">WithPlayerFilter</span><span class="punctuation">(</span>vehicleFilter<span class="punctuation">)</span>
    <span class="punctuation">.</span><span class="method">WithInputConsumption</span><span class="punctuation">(</span><span class="keyword">false</span><span class="punctuation">);</span> <span class="comment">// Let UI work</span></pre>
            </div>

            <h3>Context Processing Flow</h3>
            <div class="code-block">
<pre><span class="comment">// Context Processing Flow</span>
<span class="number">1.</span> Input action triggered <span class="punctuation">(</span><span class="enum">PlayerAction</span><span class="punctuation">.</span>Attack<span class="punctuation">)</span>
<span class="number">2.</span> Get sorted contexts by priority <span class="punctuation">(</span>highest first<span class="punctuation">)</span>
<span class="number">3.</span> For each context in priority order<span class="punctuation">:</span>
   <span class="operator">-</span> Check <span class="keyword">if</span> context allows this action
   <span class="operator">-</span> If <span class="keyword">YES</span><span class="punctuation">:</span> action allowed<span class="punctuation">,</span> stop <span class="keyword">if</span> ConsumeInput<span class="operator">=</span><span class="keyword">true</span>
   <span class="operator">-</span> If <span class="keyword">NO</span> and ConsumeInput<span class="operator">=</span><span class="keyword">true</span><span class="punctuation">:</span> action blocked
   <span class="operator">-</span> If <span class="keyword">NO</span> and ConsumeInput<span class="operator">=</span><span class="keyword">false</span><span class="punctuation">:</span> continue to next context
<span class="number">4.</span> If no context handled it<span class="punctuation">:</span> allow by default</pre>
        </section>

        <!-- API Reference Section -->
        <section id="api-reference" class="section">
            <h2>📚 Complete API Reference</h2>

            <h3>Core Input Queries</h3>

            <div class="api-method">
                <div class="signature">bool IsActionPressed(PlayerAction action)</div>
                <div class="description">Check if a player action is currently being held down.</div>
                <p><strong>Parameters:</strong> <code>action</code> - The player action to check</p>
                <p class="returns">Returns: True if the action is currently pressed</p>
            </div>

            <div class="api-method">
                <div class="signature">bool IsActionTriggered(PlayerAction action)</div>
                <div class="description">Check if a player action was triggered this frame (button down).</div>
                <p><strong>Parameters:</strong> <code>action</code> - The player action to check</p>
                <p class="returns">Returns: True if the action was triggered this frame</p>
            </div>

            <div class="api-method">
                <div class="signature">bool IsActionReleased(PlayerAction action)</div>
                <div class="description">Check if a player action was released this frame (button up).</div>
                <p><strong>Parameters:</strong> <code>action</code> - The player action to check</p>
                <p class="returns">Returns: True if the action was released this frame</p>
            </div>

            <div class="api-method">
                <div class="signature">float GetFloatValue(PlayerAction action)</div>
                <div class="description">Get the float value of a player action (for analog inputs like triggers).</div>
                <p><strong>Parameters:</strong> <code>action</code> - The player action to get value from</p>
                <p class="returns">Returns: Float value with sensitivity and curves applied</p>
            </div>

            <div class="api-method">
                <div class="signature">Vector2 GetVector2Value(PlayerAction action)</div>
                <div class="description">Get the Vector2 value of a player action (for movement/look inputs).</div>
                <p><strong>Parameters:</strong> <code>action</code> - The player action to get value from</p>
                <p class="returns">Returns: Vector2 value with device-specific sensitivity applied</p>
            </div>

            <h3>UI Action Queries</h3>
            <p>All PlayerAction methods have equivalent UIAction versions:</p>
            <div class="code-block">
<pre><span class="keyword">bool</span> <span class="method">IsActionPressed</span><span class="punctuation">(</span><span class="enum">UIAction</span> action<span class="punctuation">)</span>
<span class="keyword">bool</span> <span class="method">IsActionTriggered</span><span class="punctuation">(</span><span class="enum">UIAction</span> action<span class="punctuation">)</span>
<span class="keyword">bool</span> <span class="method">IsActionReleased</span><span class="punctuation">(</span><span class="enum">UIAction</span> action<span class="punctuation">)</span>
<span class="keyword">float</span> <span class="method">GetFloatValue</span><span class="punctuation">(</span><span class="enum">UIAction</span> action<span class="punctuation">)</span>
<span class="class-name">Vector2</span> <span class="method">GetVector2Value</span><span class="punctuation">(</span><span class="enum">UIAction</span> action<span class="punctuation">)</span></pre>

            <h3>Context Management</h3>

            <div class="api-method">
                <div class="signature">IInputContextHandle RegisterContext(InputContext context)</div>
                <div class="description">Register a new input context with the system. Returns a handle for lifecycle management.</div>
                <p><strong>Parameters:</strong> <code>context</code> - Configured InputContext to register</p>
                <p class="returns">Returns: IInputContextHandle for managing context lifecycle</p>
                <div class="examples">
                    <h4>Usage:</h4>
                    <div class="code-block">
<pre><span class="keyword">var</span> context <span class="operator">=</span> <span class="class-name">InputContext</span><span class="punctuation">.</span><span class="method">CreateModal</span><span class="punctuation">(</span><span class="enum">UIAction</span><span class="punctuation">.</span>Submit<span class="punctuation">,</span> <span class="enum">UIAction</span><span class="punctuation">.</span>Cancel<span class="punctuation">);</span>
<span class="keyword">using</span> <span class="keyword">var</span> handle <span class="operator">=</span> inputService<span class="punctuation">.</span><span class="method">RegisterContext</span><span class="punctuation">(</span>context<span class="punctuation">);</span>
<span class="comment">// Context active until handle disposed</span></pre>
                </div>
            </div>

            <div class="api-method">
                <div class="signature">IReadOnlyList&lt;InputContext&gt; GetActiveContexts()</div>
                <div class="description">Get all currently active contexts, sorted by priority (highest first).</div>
                <p class="returns">Returns: Read-only list of active contexts in priority order</p>
            </div>

            <div class="api-method">
                <div class="signature">InputContext GetHandlingContext(PlayerAction action)</div>
                <div class="description">Get the highest priority context that would handle this action.</div>
                <p><strong>Parameters:</strong> <code>action</code> - Action to check</p>
                <p class="returns">Returns: Context that would handle this action, null if blocked</p>
            </div>

            <h3>Device Management</h3>

            <div class="api-method">
                <div class="signature">InputDeviceType CurrentDeviceType { get; }</div>
                <div class="description">Get the currently active input device type.</div>
                <p class="returns">Returns: Keyboard, Mouse, Gamepad, Touch, or Unknown</p>
            </div>

            <div class="api-method">
                <div class="signature">bool IsGamepadConnected { get; }</div>
                <div class="description">Check if a gamepad is currently connected and active.</div>
                <p class="returns">Returns: True if gamepad is available</p>
            </div>

            <h3>Rebinding System</h3>

            <div class="api-method">
                <div class="signature">IRebindableAction Rebinding { get; }</div>
                <div class="description">Get access to the rebinding functionality.</div>
                <p class="returns">Returns: IRebindableAction interface for rebinding operations</p>
            </div>

            <h4>IRebindableAction Methods</h4>

            <div class="api-method">
                <div class="signature">UniTask&lt;RebindingResult&gt; StartRebindAsync(PlayerAction action, int bindingIndex = 0, float timeout = 10f)</div>
                <div class="description">Start interactive rebinding for a player action.</div>
                <p><strong>Parameters:</strong></p>
                <ul>
                    <li><code>action</code> - PlayerAction to rebind</li>
                    <li><code>bindingIndex</code> - Which binding index (for multiple bindings per action)</li>
                    <li><code>timeout</code> - Timeout in seconds</li>
                </ul>
                <p class="returns">Returns: RebindingResult with success/failure details</p>
            </div>

            <div class="api-method">
                <div class="signature">UniTask&lt;bool&gt; SaveBindingsAsync()</div>
                <div class="description">Save current binding configuration to SaveLoadService.</div>
                <p class="returns">Returns: True if save successful</p>
            </div>

            <div class="api-method">
                <div class="signature">UniTask&lt;bool&gt; LoadBindingsAsync()</div>
                <div class="description">Load binding configuration from SaveLoadService.</div>
                <p class="returns">Returns: True if load successful</p>
            </div>

            <h3>Utility Methods</h3>

            <div class="api-method">
                <div class="signature">UniTask WaitForAction(PlayerAction action)</div>
                <div class="description">Asynchronously wait for a specific player action to be triggered.</div>
                <p><strong>Parameters:</strong> <code>action</code> - Action to wait for</p>
                <p class="returns">Returns: UniTask that completes when action triggered</p>
            </div>

            <h3>Events</h3>

            <div class="api-method">
                <div class="signature">event Action&lt;PlayerAction, InputActionPhase&gt; OnPlayerActionTriggered</div>
                <div class="description">Event triggered when any player action state changes.</div>
            </div>

            <div class="api-method">
                <div class="signature">event Action&lt;UIAction, InputActionPhase&gt; OnUIActionTriggered</div>
                <div class="description">Event triggered when any UI action state changes.</div>
            </div>

            <div class="api-method">
                <div class="signature">event Action&lt;IReadOnlyList&lt;InputContext&gt;&gt; OnContextsChanged</div>
                <div class="description">Event triggered when input contexts are added or removed.</div>
            </div>

            <div class="api-method">
                <div class="signature">event Action&lt;InputDeviceType, InputDeviceType&gt; OnDeviceChanged</div>
                <div class="description">Event triggered when the active input device changes.</div>
            </div>
        </section>

        <!-- Usage Examples Section -->
        <section id="usage-examples" class="section">
            <h2>💡 Usage Examples</h2>
            <p class="section-intro">Real-world scenarios showing how to use the InputService effectively</p>
            
            <div class="example-container">
                <h3>🎮 1. Basic Player Input</h3>
                <p class="example-desc"><strong>Scenario:</strong> Standard gameplay input handling</p>
                
                <div class="code-block">
<pre><span class="keyword">public class</span> <span class="class-name">PlayerController</span> <span class="punctuation">:</span> <span class="class-name">MonoBehaviour</span>
<span class="punctuation">{</span>
    <span class="keyword">private</span> <span class="interface">IInputService</span> <span class="punctuation">_</span>inputService<span class="punctuation">;</span>
    <span class="punctuation">[</span><span class="class-name">SerializeField</span><span class="punctuation">]</span> <span class="keyword">private</span> <span class="keyword">float</span> moveSpeed <span class="operator">=</span> <span class="number">5f</span><span class="punctuation">;</span>
    
    <span class="keyword">void</span> <span class="method">Start</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="comment">// Get input service from engine</span>
        <span class="punctuation">_</span>inputService <span class="operator">=</span> <span class="class-name">Engine</span><span class="punctuation">.</span><span class="method">GetService</span><span class="operator">&lt;</span><span class="interface">IInputService</span><span class="operator">&gt;</span><span class="punctuation">();</span>
    <span class="punctuation">}</span>
    
    <span class="keyword">void</span> <span class="method">Update</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="comment">// ✅ One-time trigger (perfect for jump/shoot)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">_</span>inputService<span class="punctuation">.</span><span class="method">IsActionTriggered</span><span class="punctuation">(</span><span class="enum">PlayerAction</span><span class="punctuation">.</span>Jump<span class="punctuation">))</span>
        <span class="punctuation">{</span>
            <span class="method">Jump</span><span class="punctuation">();</span>
        <span class="punctuation">}</span>

        <span class="comment">// ✅ Continuous movement with sensitivity applied</span>
        <span class="keyword">var</span> movement <span class="operator">=</span> <span class="punctuation">_</span>inputService<span class="punctuation">.</span><span class="method">GetVector2Value</span><span class="punctuation">(</span><span class="enum">PlayerAction</span><span class="punctuation">.</span>Move<span class="punctuation">);</span>
        transform<span class="punctuation">.</span><span class="method">Translate</span><span class="punctuation">(</span>movement <span class="operator">*</span> moveSpeed <span class="operator">*</span> <span class="class-name">Time</span><span class="punctuation">.</span>deltaTime<span class="punctuation">);</span>

        <span class="comment">// ✅ Hold to charge (continuous press)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">_</span>inputService<span class="punctuation">.</span><span class="method">IsActionPressed</span><span class="punctuation">(</span><span class="enum">PlayerAction</span><span class="punctuation">.</span>Attack<span class="punctuation">))</span>
        <span class="punctuation">{</span>
            <span class="method">ChargeAttack</span><span class="punctuation">();</span>
        <span class="punctuation">}</span>
        
        <span class="comment">// ✅ Release detection (end charge attack)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">_</span>inputService<span class="punctuation">.</span><span class="method">IsActionReleased</span><span class="punctuation">(</span><span class="enum">PlayerAction</span><span class="punctuation">.</span>Attack<span class="punctuation">))</span>
        <span class="punctuation">{</span>
            <span class="method">ExecuteChargedAttack</span><span class="punctuation">();</span>
        <span class="punctuation">}</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span></pre>
                </div>
            </div>

            <div class="example-container">
                <h3>🔒 2. Simple Input Blocking</h3>
                <p class="example-desc"><strong>Scenario:</strong> Block player input during cutscenes</p>
                
                <div class="code-block">
<pre><span class="keyword">public class</span> <span class="class-name">CutsceneManager</span> <span class="punctuation">:</span> <span class="class-name">MonoBehaviour</span>
<span class="punctuation">{</span>
    <span class="keyword">private</span> <span class="interface">IInputService</span> <span class="punctuation">_</span>inputService<span class="punctuation">;</span>
    <span class="keyword">private</span> <span class="interface">IInputContextHandle</span> <span class="punctuation">_</span>cutsceneHandle<span class="punctuation">;</span>

    <span class="keyword">public</span> <span class="keyword">void</span> <span class="method">StartCutscene</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="comment">// ✅ Create context that blocks player actions, allows skip</span>
        <span class="keyword">var</span> context <span class="operator">=</span> <span class="class-name">InputContext</span><span class="punctuation">.</span><span class="method">CreateModal</span><span class="punctuation">(</span><span class="enum">UIAction</span><span class="punctuation">.</span>Skip<span class="punctuation">);</span>

        <span class="comment">// ✅ Register context (automatic cleanup with handle)</span>
        <span class="punctuation">_</span>cutsceneHandle <span class="operator">=</span> <span class="punctuation">_</span>inputService<span class="punctuation">.</span><span class="method">RegisterContext</span><span class="punctuation">(</span>context<span class="punctuation">);</span>
        
        <span class="comment">// Player can't move/attack/interact, but can skip cutscene</span>
    <span class="punctuation">}</span>

    <span class="keyword">public</span> <span class="keyword">void</span> <span class="method">EndCutscene</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="comment">// ✅ Clean disposal restores player input</span>
        <span class="punctuation">_</span>cutsceneHandle<span class="operator">?.</span><span class="method">Dispose</span><span class="punctuation">();</span>
        <span class="punctuation">_</span>cutsceneHandle <span class="operator">=</span> <span class="keyword">null</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span></pre>
                </div>
            </div>

            <div class="example-container">
                <h3>📱 3. Menu System Integration</h3>
                <p class="example-desc"><strong>Scenario:</strong> Pause menu that blocks gameplay but allows UI navigation</p>
                
                <div class="code-block">
<pre><span class="keyword">public class</span> <span class="class-name">PauseMenu</span> <span class="punctuation">:</span> <span class="class-name">MonoBehaviour</span>
<span class="punctuation">{</span>
    <span class="keyword">private</span> <span class="interface">IInputService</span> <span class="punctuation">_</span>inputService<span class="punctuation">;</span>
    <span class="keyword">private</span> <span class="interface">IInputContextHandle</span> <span class="punctuation">_</span>pauseHandle<span class="punctuation">;</span>

    <span class="keyword">void</span> <span class="method">OnEnable</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="punctuation">_</span>inputService <span class="operator">=</span> <span class="class-name">Engine</span><span class="punctuation">.</span><span class="method">GetService</span><span class="operator">&lt;</span><span class="interface">IInputService</span><span class="operator">&gt;</span><span class="punctuation">();</span>

        <span class="comment">// ✅ Menu context - blocks gameplay, allows UI</span>
        <span class="keyword">var</span> menuContext <span class="operator">=</span> <span class="class-name">InputContext</span><span class="punctuation">.</span><span class="method">CreateMenu</span><span class="punctuation">();</span>
        
        <span class="punctuation">_</span>pauseHandle <span class="operator">=</span> <span class="punctuation">_</span>inputService<span class="punctuation">.</span><span class="method">RegisterContext</span><span class="punctuation">(</span>menuContext<span class="punctuation">);</span>
        
        <span class="comment">// Player can navigate menu but can't move character</span>
    <span class="punctuation">}</span>

    <span class="keyword">void</span> <span class="method">OnDisable</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="comment">// ✅ Always clean up contexts</span>
        <span class="punctuation">_</span>pauseHandle<span class="operator">?.</span><span class="method">Dispose</span><span class="punctuation">();</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span></pre>
                </div>
            </div>

            <div class="example-container">
                <h3>🏗️ 4. Complex UI Layering</h3>
                <p class="example-desc"><strong>Scenario:</strong> Inventory with confirmation dialogs</p>
                
                <div class="code-block">
<pre><span class="keyword">public class</span> <span class="class-name">InventoryScreen</span> <span class="punctuation">:</span> <span class="class-name">MonoBehaviour</span>
<span class="punctuation">{</span>
    <span class="keyword">private</span> <span class="interface">IInputService</span> <span class="punctuation">_</span>inputService<span class="punctuation">;</span>
    <span class="keyword">private</span> <span class="interface">IInputContextHandle</span> <span class="punctuation">_</span>inventoryHandle<span class="punctuation">;</span>
    <span class="keyword">private</span> <span class="interface">IInputContextHandle</span> <span class="punctuation">_</span>confirmHandle<span class="punctuation">;</span>

    <span class="keyword">void</span> <span class="method">OnEnable</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="comment">// ✅ Base inventory context</span>
        <span class="keyword">var</span> inventoryContext <span class="operator">=</span> <span class="class-name">InputContext</span><span class="punctuation">.</span><span class="method">CreateMenu</span><span class="punctuation">();</span>
        <span class="punctuation">_</span>inventoryHandle <span class="operator">=</span> <span class="punctuation">_</span>inputService<span class="punctuation">.</span><span class="method">RegisterContext</span><span class="punctuation">(</span>inventoryContext<span class="punctuation">);</span>
    <span class="punctuation">}</span>

    <span class="keyword">public</span> <span class="keyword">void</span> <span class="method">ShowDeleteConfirmation</span><span class="punctuation">(</span><span class="keyword">string</span> itemName<span class="punctuation">)</span>
    <span class="punctuation">{</span>
        <span class="comment">// ✅ Layer confirmation dialog on top</span>
        <span class="keyword">var</span> confirmContext <span class="operator">=</span> <span class="class-name">InputContext</span><span class="punctuation">.</span><span class="method">CreateModal</span><span class="punctuation">(</span>
            <span class="enum">UIAction</span><span class="punctuation">.</span>Submit<span class="punctuation">,</span>     <span class="comment">// Confirm</span>
            <span class="enum">UIAction</span><span class="punctuation">.</span>Cancel      <span class="comment">// Cancel</span>
        <span class="punctuation">);</span>

        <span class="punctuation">_</span>confirmHandle <span class="operator">=</span> <span class="punctuation">_</span>inputService<span class="punctuation">.</span><span class="method">RegisterContext</span><span class="punctuation">(</span>confirmContext<span class="punctuation">);</span>
        
        <span class="comment">// Modal automatically blocks inventory navigation</span>
        <span class="comment">// Player can only confirm or cancel</span>
    <span class="punctuation">}</span>

    <span class="keyword">public</span> <span class="keyword">void</span> <span class="method">OnConfirmDelete</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="comment">// Process deletion...</span>
        
        <span class="comment">// ✅ Remove confirmation dialog</span>
        <span class="punctuation">_</span>confirmHandle<span class="operator">?.</span><span class="method">Dispose</span><span class="punctuation">();</span>
        <span class="punctuation">_</span>confirmHandle <span class="operator">=</span> <span class="keyword">null</span><span class="punctuation">;</span>
        
        <span class="comment">// Inventory navigation automatically restored</span>
    <span class="punctuation">}</span>

    <span class="keyword">void</span> <span class="method">OnDisable</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="punctuation">_</span>inventoryHandle<span class="operator">?.</span><span class="method">Dispose</span><span class="punctuation">();</span>
        <span class="punctuation">_</span>confirmHandle<span class="operator">?.</span><span class="method">Dispose</span><span class="punctuation">();</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span></pre>
                </div>
            </div>

            <div class="example-container">
                <h3>⚙️ 5. Key Remapping Interface</h3>
                <p class="example-desc"><strong>Scenario:</strong> Settings screen for customizing controls</p>
                
                <div class="code-block">
<pre><span class="keyword">public class</span> <span class="class-name">KeybindingUI</span> <span class="punctuation">:</span> <span class="class-name">MonoBehaviour</span>
<span class="punctuation">{</span>
    <span class="keyword">private</span> <span class="interface">IInputService</span> <span class="punctuation">_</span>inputService<span class="punctuation">;</span>
    <span class="keyword">private</span> <span class="interface">IRebindableAction</span> <span class="punctuation">_</span>rebinding<span class="punctuation">;</span>

    <span class="keyword">void</span> <span class="method">Start</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="punctuation">_</span>inputService <span class="operator">=</span> <span class="class-name">Engine</span><span class="punctuation">.</span><span class="method">GetService</span><span class="operator">&lt;</span><span class="interface">IInputService</span><span class="operator">&gt;</span><span class="punctuation">();</span>
        <span class="punctuation">_</span>rebinding <span class="operator">=</span> <span class="punctuation">_</span>inputService<span class="punctuation">.</span>Rebinding<span class="punctuation">;</span>
    <span class="punctuation">}</span>

    <span class="comment">// Called when player clicks "Rebind Jump" button</span>
    <span class="keyword">public</span> <span class="keyword">async</span> <span class="keyword">void</span> <span class="method">RebindJump</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="method">ShowPrompt</span><span class="punctuation">(</span><span class="string">"Press new key for Jump..."</span><span class="punctuation">);</span>
        
        <span class="keyword">try</span> 
        <span class="punctuation">{</span>
            <span class="comment">// ✅ Start interactive rebinding</span>
            <span class="keyword">var</span> result <span class="operator">=</span> <span class="keyword">await</span> <span class="punctuation">_</span>rebinding<span class="punctuation">.</span><span class="method">StartRebindAsync</span><span class="punctuation">(</span>
                <span class="enum">PlayerAction</span><span class="punctuation">.</span>Jump<span class="punctuation">,</span>
                bindingIndex<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span>        <span class="comment">// Primary binding</span>
                timeout<span class="punctuation">:</span> <span class="number">10f</span>            <span class="comment">// 10 second timeout</span>
            <span class="punctuation">);</span>

            <span class="comment">// ✅ Handle all outcomes</span>
            <span class="keyword">switch</span> <span class="punctuation">(</span>result<span class="punctuation">.</span>Status<span class="punctuation">)</span>
            <span class="punctuation">{</span>
                <span class="keyword">case</span> <span class="enum">RebindingStatus</span><span class="punctuation">.</span>Success<span class="punctuation">:</span>
                    <span class="method">ShowSuccess</span><span class="punctuation">(</span><span class="string">$"Jump → {result.DisplayName}"</span><span class="punctuation">);</span>
                    <span class="keyword">await</span> <span class="punctuation">_</span>rebinding<span class="punctuation">.</span><span class="method">SaveBindingsAsync</span><span class="punctuation">();</span>
                    <span class="keyword">break</span><span class="punctuation">;</span>

                <span class="keyword">case</span> <span class="enum">RebindingStatus</span><span class="punctuation">.</span>Conflict<span class="punctuation">:</span>
                    <span class="method">ShowError</span><span class="punctuation">(</span><span class="string">$"Already used by {result.ConflictingAction}"</span><span class="punctuation">);</span>
                    <span class="keyword">break</span><span class="punctuation">;</span>

                <span class="keyword">case</span> <span class="enum">RebindingStatus</span><span class="punctuation">.</span>Timeout<span class="punctuation">:</span>
                    <span class="method">ShowMessage</span><span class="punctuation">(</span><span class="string">"Rebinding cancelled"</span><span class="punctuation">);</span>
                    <span class="keyword">break</span><span class="punctuation">;</span>
            <span class="punctuation">}</span>
        <span class="punctuation">}</span>
        <span class="keyword">finally</span>
        <span class="punctuation">{</span>
            <span class="method">HidePrompt</span><span class="punctuation">();</span>
        <span class="punctuation">}</span>
    <span class="punctuation">}</span>

    <span class="keyword">public</span> <span class="keyword">async</span> <span class="keyword">void</span> <span class="method">ResetAllKeys</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="keyword">var</span> count <span class="operator">=</span> <span class="punctuation">_</span>rebinding<span class="punctuation">.</span><span class="method">ResetAllBindings</span><span class="punctuation">();</span>
        <span class="method">ShowMessage</span><span class="punctuation">(</span><span class="string">$"Reset {count} bindings"</span><span class="punctuation">);</span>
        <span class="keyword">await</span> <span class="punctuation">_</span>rebinding<span class="punctuation">.</span><span class="method">SaveBindingsAsync</span><span class="punctuation">();</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span></pre>
                </div>
            </div>

            <div class="example-container">
                <h3>🎯 6. Device-Adaptive UI</h3>
                <p class="example-desc"><strong>Scenario:</strong> Show different prompts for keyboard vs gamepad</p>
                
                <div class="code-block">
<pre><span class="keyword">public class</span> <span class="class-name">InteractionPrompt</span> <span class="punctuation">:</span> <span class="class-name">MonoBehaviour</span>
<span class="punctuation">{</span>
    <span class="keyword">private</span> <span class="interface">IInputService</span> <span class="punctuation">_</span>inputService<span class="punctuation">;</span>
    
    <span class="punctuation">[</span><span class="class-name">SerializeField</span><span class="punctuation">]</span> <span class="keyword">private</span> <span class="class-name">GameObject</span> keyboardPrompt<span class="punctuation">;</span>
    <span class="punctuation">[</span><span class="class-name">SerializeField</span><span class="punctuation">]</span> <span class="keyword">private</span> <span class="class-name">GameObject</span> gamepadPrompt<span class="punctuation">;</span>

    <span class="keyword">void</span> <span class="method">Start</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="punctuation">_</span>inputService <span class="operator">=</span> <span class="class-name">Engine</span><span class="punctuation">.</span><span class="method">GetService</span><span class="operator">&lt;</span><span class="interface">IInputService</span><span class="operator">&gt;</span><span class="punctuation">();</span>
        
        <span class="comment">// ✅ Listen for device changes</span>
        <span class="punctuation">_</span>inputService<span class="punctuation">.</span>OnDeviceChanged <span class="operator">+=</span> <span class="method">UpdatePrompts</span><span class="punctuation">;</span>
        
        <span class="comment">// Set initial state</span>
        <span class="method">UpdatePrompts</span><span class="punctuation">(</span><span class="punctuation">_</span>inputService<span class="punctuation">.</span>CurrentDeviceType<span class="punctuation">,</span> <span class="punctuation">_</span>inputService<span class="punctuation">.</span>CurrentDeviceType<span class="punctuation">);</span>
    <span class="punctuation">}</span>

    <span class="keyword">void</span> <span class="method">UpdatePrompts</span><span class="punctuation">(</span><span class="enum">InputDeviceType</span> oldDevice<span class="punctuation">,</span> <span class="enum">InputDeviceType</span> newDevice<span class="punctuation">)</span>
    <span class="punctuation">{</span>
        <span class="comment">// ✅ Automatically switch UI based on device</span>
        <span class="keyword">bool</span> isGamepad <span class="operator">=</span> newDevice <span class="operator">==</span> <span class="enum">InputDeviceType</span><span class="punctuation">.</span>Gamepad<span class="punctuation">;</span>
        
        keyboardPrompt<span class="punctuation">.</span><span class="method">SetActive</span><span class="punctuation">(!</span>isGamepad<span class="punctuation">);</span>
        gamepadPrompt<span class="punctuation">.</span><span class="method">SetActive</span><span class="punctuation">(</span>isGamepad<span class="punctuation">);</span>
        
        <span class="comment">// Could show "Press E" vs "Press A" prompts</span>
    <span class="punctuation">}</span>

    <span class="keyword">void</span> <span class="method">OnDestroy</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">_</span>inputService <span class="operator">!=</span> <span class="keyword">null</span><span class="punctuation">)</span>
            <span class="punctuation">_</span>inputService<span class="punctuation">.</span>OnDeviceChanged <span class="operator">-=</span> <span class="method">UpdatePrompts</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span></pre>
                </div>
            </div>

            <div class="tip-box">
                <h4>💡 Best Practices</h4>
                <ul>
                    <li><strong>Always dispose contexts:</strong> Use <code>using</code> statements or manual disposal in OnDisable/OnDestroy</li>
                    <li><strong>Layer priorities work automatically:</strong> System > Critical > Modal > Menus > GameplayUI > Gameplay</li>
                    <li><strong>Test with multiple devices:</strong> Your game should work seamlessly with keyboard and gamepad</li>
                    <li><strong>Handle rebinding conflicts:</strong> Show clear messages when keys conflict</li>
                    <li><strong>Debug active contexts:</strong> Use <code>GetActiveContexts()</code> to see what's blocking input</li>
                    <li><strong>Use factory methods:</strong> <code>CreateModal()</code>, <code>CreateMenu()</code>, <code>CreateGameplay()</code></li>
                </ul>
            </div>
        </section>

        <!-- Configuration Section -->
        <section id="configuration" class="section">
            <h2>⚙️ Configuration System</h2>

            <p>InputService is configured via <code class="inline-code">InputServiceConfiguration</code> ScriptableObject:</p>

            <div class="code-block">
<pre><span class="punctuation">[</span><span class="class-name">CreateAssetMenu</span><span class="punctuation">(</span>fileName <span class="operator">=</span> <span class="string">"InputServiceConfiguration"</span><span class="punctuation">,</span>
                 menuName <span class="operator">=</span> <span class="string">"Engine/Services/InputServiceConfiguration"</span><span class="punctuation">)]</span>
<span class="keyword">public class</span> <span class="class-name">InputServiceConfiguration</span> <span class="punctuation">:</span> <span class="class-name">ServiceConfigurationBase</span></pre>

            <h3>Configuration Properties</h3>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Property</th>
                            <th>Type</th>
                            <th>Default</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>EnableInEditor</code></td>
                            <td>bool</td>
                            <td>true</td>
                            <td>Enable input system in Unity editor</td>
                        </tr>
                        <tr>
                            <td><code>AutoSwitchDevices</code></td>
                            <td>bool</td>
                            <td>true</td>
                            <td>Automatically switch to most recent device</td>
                        </tr>
                        <tr>
                            <td><code>MouseSensitivity</code></td>
                            <td>float</td>
                            <td>1.0</td>
                            <td>Mouse sensitivity multiplier (0.1-10)</td>
                        </tr>
                        <tr>
                            <td><code>GamepadSensitivity</code></td>
                            <td>float</td>
                            <td>1.0</td>
                            <td>Gamepad sensitivity multiplier (0.1-10)</td>
                        </tr>
                        <tr>
                            <td><code>SensitivityCurve</code></td>
                            <td>AnimationCurve</td>
                            <td>Linear</td>
                            <td>Curve applied to analog inputs</td>
                        </tr>
                        <tr>
                            <td><code>MaxContextStackSize</code></td>
                            <td>int</td>
                            <td>10</td>
                            <td>Maximum number of active contexts</td>
                        </tr>
                        <tr>
                            <td><code>InputUpdateRate</code></td>
                            <td>int</td>
                            <td>60</td>
                            <td>Input processing frequency (Hz)</td>
                        </tr>
                        <tr>
                            <td><code>AutoSaveBindings</code></td>
                            <td>bool</td>
                            <td>true</td>
                            <td>Automatically save bindings after rebind</td>
                        </tr>
                        <tr>
                            <td><code>EnableDetailedLogging</code></td>
                            <td>bool</td>
                            <td>false</td>
                            <td>Enable verbose debug logging</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Runtime Configuration Updates</h3>
            <div class="code-block">
<pre><span class="comment">// Configuration can be updated at runtime</span>
<span class="keyword">var</span> inputService <span class="operator">=</span> <span class="class-name">Engine</span><span class="punctuation">.</span><span class="method">GetService</span><span class="operator">&lt;</span><span class="interface">IInputService</span><span class="operator">&gt;</span><span class="punctuation">();</span>
<span class="keyword">var</span> config <span class="operator">=</span> inputService<span class="punctuation">.</span>Configuration<span class="punctuation">;</span>

config<span class="punctuation">.</span>MouseSensitivity <span class="operator">=</span> <span class="number">2.0f</span><span class="punctuation">;</span>
config<span class="punctuation">.</span>AutoSwitchDevices <span class="operator">=</span> <span class="keyword">false</span><span class="punctuation">;</span>

<span class="comment">// Changes apply immediately</span></pre>
        </section>

        <!-- Rebinding Section -->
        <section id="rebinding" class="section">
            <h2>🔄 Rebinding System</h2>

            <p>Professional input rebinding system with SaveLoadService integration.</p>

            <h3>System Components</h3>

            <div class="feature-grid">
                <div class="feature-card">
                    <h4>InputRebindingManager</h4>
                    <p>Core rebinding logic with conflict detection, validation, and timeout handling.</p>
                </div>

                <div class="feature-card">
                    <h4>InputBindingPersistence</h4>
                    <p>SaveLoadService integration for persistent binding storage and profile management.</p>
                </div>

                <div class="feature-card">
                    <h4>InputBindingsSaveData</h4>
                    <p>Type-safe SaveData class for binding configurations with validation and versioning.</p>
                </div>

                <div class="feature-card">
                    <h4>RebindButton</h4>
                    <p>Ready-to-use UI component for interactive rebinding with visual feedback.</p>
                </div>
            </div>

            <h3>Binding Data Structure</h3>
            <div class="code-block">
<pre><span class="punctuation">[</span><span class="class-name">Serializable</span><span class="punctuation">]</span>
<span class="keyword">public class</span> <span class="class-name">InputBindingsSaveData</span> <span class="punctuation">:</span> <span class="class-name">SaveData</span>
<span class="punctuation">{</span>
    <span class="keyword">public</span> <span class="keyword">string</span> activeProfileName <span class="operator">=</span> <span class="string">"Default"</span><span class="punctuation">;</span>
    <span class="keyword">public</span> <span class="class-name">List</span><span class="operator">&lt;</span><span class="class-name">InputBindingData</span><span class="operator">&gt;</span> bindings<span class="punctuation">;</span>
    <span class="keyword">public</span> <span class="class-name">List</span><span class="operator">&lt;</span><span class="class-name">InputBindingProfile</span><span class="operator">&gt;</span> profiles<span class="punctuation">;</span>
    <span class="keyword">public</span> <span class="class-name">Dictionary</span><span class="operator">&lt;</span><span class="keyword">string</span><span class="punctuation">,</span> <span class="keyword">object</span><span class="operator">&gt;</span> settings<span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="punctuation">[</span><span class="class-name">Serializable</span><span class="punctuation">]</span>
<span class="keyword">public class</span> <span class="class-name">InputBindingProfile</span>
<span class="punctuation">{</span>
    <span class="keyword">public</span> <span class="keyword">string</span> profileName<span class="punctuation">;</span>
    <span class="keyword">public</span> <span class="class-name">DateTime</span> created<span class="punctuation">;</span>
    <span class="keyword">public</span> <span class="class-name">DateTime</span> lastModified<span class="punctuation">;</span>
    <span class="keyword">public</span> <span class="class-name">List</span><span class="operator">&lt;</span><span class="class-name">InputBindingData</span><span class="operator">&gt;</span> bindings<span class="punctuation">;</span>
<span class="punctuation">}</span></pre>

            <h3>Rebinding Workflow</h3>
            <div class="code-block">
<pre><span class="comment">// Rebinding Workflow</span>
<span class="number">1.</span> User clicks rebind button
<span class="number">2.</span> UI calls <span class="method">StartRebindAsync</span><span class="punctuation">()</span>
<span class="number">3.</span> System enters rebinding mode
<span class="number">4.</span> User presses new key<span class="operator">/</span>button
<span class="number">5.</span> System validates input<span class="punctuation">:</span>
   <span class="operator">-</span> Not reserved key <span class="punctuation">(</span>ESC<span class="punctuation">,</span> F4<span class="punctuation">,</span> etc<span class="punctuation">.</span><span class="punctuation">)</span>
   <span class="operator">-</span> No conflicts with existing bindings
   <span class="operator">-</span> Valid input device
<span class="number">6.</span> If valid<span class="punctuation">:</span> Apply binding<span class="punctuation">,</span> save <span class="keyword">if</span> AutoSave enabled
<span class="number">7.</span> If invalid<span class="punctuation">:</span> Show error<span class="punctuation">,</span> allow retry
<span class="number">8.</span> Return <span class="class-name">RebindingResult</span> with status</pre>

            <h3>Binding Index System</h3>
            <p>Each action can have multiple bindings (e.g., WASD + Arrow Keys for movement):</p>
            <div class="code-block">
<pre><span class="comment">// Rebind first binding (index 0) - WASD keys</span>
<span class="keyword">await</span> rebindingManager<span class="punctuation">.</span><span class="method">StartRebindAsync</span><span class="punctuation">(</span><span class="enum">PlayerAction</span><span class="punctuation">.</span>Move<span class="punctuation">,</span> bindingIndex<span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">);</span>

<span class="comment">// Rebind second binding (index 1) - Arrow keys</span>
<span class="keyword">await</span> rebindingManager<span class="punctuation">.</span><span class="method">StartRebindAsync</span><span class="punctuation">(</span><span class="enum">PlayerAction</span><span class="punctuation">.</span>Move<span class="punctuation">,</span> bindingIndex<span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">);</span></pre>

            <h3>RebindButton Component</h3>
            <div class="code-block">
<pre><span class="keyword">public class</span> <span class="class-name">RebindButton</span> <span class="punctuation">:</span> <span class="class-name">EngineBehaviour</span>
<span class="punctuation">{</span>
    <span class="punctuation">[</span><span class="class-name">SerializeField</span><span class="punctuation">]</span> <span class="keyword">private</span> <span class="enum">PlayerAction</span> <span class="punctuation">_</span>playerAction<span class="punctuation">;</span>
    <span class="punctuation">[</span><span class="class-name">SerializeField</span><span class="punctuation">]</span> <span class="keyword">private</span> <span class="keyword">int</span> <span class="punctuation">_</span>bindingIndex <span class="operator">=</span> <span class="number">0</span><span class="punctuation">;</span>
    <span class="punctuation">[</span><span class="class-name">SerializeField</span><span class="punctuation">]</span> <span class="keyword">private</span> <span class="keyword">float</span> <span class="punctuation">_</span>rebindTimeout <span class="operator">=</span> <span class="number">10f</span><span class="punctuation">;</span>

    <span class="comment">// Visual feedback components</span>
    <span class="punctuation">[</span><span class="class-name">SerializeField</span><span class="punctuation">]</span> <span class="keyword">private</span> <span class="class-name">Button</span> <span class="punctuation">_</span>button<span class="punctuation">;</span>
    <span class="punctuation">[</span><span class="class-name">SerializeField</span><span class="punctuation">]</span> <span class="keyword">private</span> <span class="class-name">TextMeshProUGUI</span> <span class="punctuation">_</span>bindingText<span class="punctuation">;</span>
    <span class="punctuation">[</span><span class="class-name">SerializeField</span><span class="punctuation">]</span> <span class="keyword">private</span> <span class="class-name">GameObject</span> <span class="punctuation">_</span>waitingIndicator<span class="punctuation">;</span>
    <span class="punctuation">[</span><span class="class-name">SerializeField</span><span class="punctuation">]</span> <span class="keyword">private</span> <span class="class-name">AudioClip</span> <span class="punctuation">_</span>rebindSuccessSound<span class="punctuation">;</span>

    <span class="keyword">public</span> <span class="keyword">event</span> <span class="class-name">Action</span><span class="operator">&lt;</span><span class="class-name">RebindingResult</span><span class="operator">&gt;</span> OnRebindCompleted<span class="punctuation">;</span>

    <span class="comment">// Automatic UI updates with visual feedback</span>
<span class="punctuation">}</span></pre>
        </section>

        <!-- Advanced Features Section -->
        <section id="advanced" class="section">
            <h2>🚀 Advanced Features</h2>

            <h3>Device-Specific Sensitivity</h3>
            <p>Automatic sensitivity application based on the detected input device:</p>
            <div class="code-block">
<pre><span class="keyword">public</span> <span class="class-name">Vector2</span> <span class="method">GetVector2Value</span><span class="punctuation">(</span><span class="enum">PlayerAction</span> action<span class="punctuation">)</span>
<span class="punctuation">{</span>
    <span class="keyword">var</span> rawValue <span class="operator">=</span> <span class="class-name">InputActionMappings</span><span class="punctuation">.</span><span class="method">GetVector2Value</span><span class="punctuation">(</span>action<span class="punctuation">);</span>
    
    <span class="comment">// Apply device-specific sensitivity automatically</span>
    <span class="keyword">var</span> processedValue <span class="operator">=</span> <span class="punctuation">_</span>sensitivityProcessor<span class="punctuation">.</span><span class="method">ApplySensitivity</span><span class="punctuation">(</span>rawValue<span class="punctuation">);</span>
    
    <span class="keyword">return</span> processedValue<span class="punctuation">;</span>
<span class="punctuation">}</span></pre>

            <h3>Sensitivity Curves</h3>
            <p>Non-linear input response using Unity AnimationCurves:</p>
            <div class="code-block">
<pre><span class="comment">// Configuration: Ease-in curve for precise aiming</span>
<span class="punctuation">_</span>config<span class="punctuation">.</span>SensitivityCurve <span class="operator">=</span> <span class="class-name">AnimationCurve</span><span class="punctuation">.</span><span class="method">EaseInOut</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">);</span>

<span class="comment">// Applied automatically to all analog inputs</span>
<span class="class-name">Vector2</span> <span class="method">ApplySensitivity</span><span class="punctuation">(</span><span class="class-name">Vector2</span> rawInput<span class="punctuation">)</span>
<span class="punctuation">{</span>
    <span class="keyword">var</span> magnitude <span class="operator">=</span> rawInput<span class="punctuation">.</span>magnitude<span class="punctuation">;</span>
    <span class="keyword">var</span> direction <span class="operator">=</span> rawInput<span class="punctuation">.</span>normalized<span class="punctuation">;</span>
    
    <span class="comment">// Apply curve to magnitude only</span>
    <span class="keyword">var</span> curvedMagnitude <span class="operator">=</span> <span class="punctuation">_</span>config<span class="punctuation">.</span>SensitivityCurve<span class="punctuation">.</span><span class="method">Evaluate</span><span class="punctuation">(</span>magnitude<span class="punctuation">);</span>
    
    <span class="keyword">return</span> direction <span class="operator">*</span> curvedMagnitude <span class="operator">*</span> <span class="method">GetSensitivityMultiplier</span><span class="punctuation">();</span>
<span class="punctuation">}</span></pre>

            <h3>Event-Based Device Detection</h3>
            <p>High-performance device switching with zero polling overhead:</p>
            <div class="code-block">
<pre><span class="keyword">public class</span> <span class="class-name">InputDeviceTracker</span>
<span class="punctuation">{</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="method">Initialize</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="comment">// Register for Unity Input System events</span>
        <span class="class-name">InputSystem</span><span class="punctuation">.</span>onActionChange <span class="operator">+=</span> <span class="method">OnActionChange</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>

    <span class="keyword">private</span> <span class="keyword">void</span> <span class="method">OnActionChange</span><span class="punctuation">(</span><span class="keyword">object</span> obj<span class="punctuation">,</span> <span class="class-name">InputActionChange</span> change<span class="punctuation">)</span>
    <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span>change <span class="operator">==</span> <span class="class-name">InputActionChange</span><span class="punctuation">.</span>ActionPerformed<span class="punctuation">)</span>
        <span class="punctuation">{</span>
            <span class="keyword">var</span> action <span class="operator">=</span> obj <span class="keyword">as</span> <span class="class-name">InputAction</span><span class="punctuation">;</span>
            <span class="keyword">var</span> device <span class="operator">=</span> action<span class="operator">?.</span>activeControl<span class="operator">?.</span>device<span class="punctuation">;</span>
            
            <span class="keyword">if</span> <span class="punctuation">(</span>device <span class="operator">!=</span> <span class="keyword">null</span> <span class="operator">&&</span> <span class="method">ShouldSwitchDevice</span><span class="punctuation">(</span>device<span class="punctuation">))</span>
            <span class="punctuation">{</span>
                <span class="method">SwitchToDevice</span><span class="punctuation">(</span>device<span class="punctuation">);</span>
            <span class="punctuation">}</span>
        <span class="punctuation">}</span>
    <span class="punctuation">}</span>

    <span class="comment">// &lt;0.01ms performance impact</span>
<span class="punctuation">}</span></pre>

            <h3>Memory Management</h3>
            <p>Zero-allocation input queries with proper cleanup:</p>
            <div class="code-block">
<pre><span class="comment">// No allocations during gameplay</span>
<span class="keyword">public</span> <span class="keyword">bool</span> <span class="method">IsActionPressed</span><span class="punctuation">(</span><span class="enum">PlayerAction</span> action<span class="punctuation">)</span>
<span class="punctuation">{</span>
    <span class="comment">// Early return if blocked - no expensive operations</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="operator">!</span><span class="punctuation">_</span>isInitialized <span class="operator">||</span> <span class="method">IsActionBlocked</span><span class="punctuation">(</span>action<span class="punctuation">))</span>
        <span class="keyword">return</span> <span class="keyword">false</span><span class="punctuation">;</span>

    <span class="comment">// Cached delegate lookup - no reflection</span>
    <span class="keyword">return</span> <span class="class-name">InputActionMappings</span><span class="punctuation">.</span><span class="method">IsActionPressed</span><span class="punctuation">(</span>action<span class="punctuation">);</span>
<span class="punctuation">}</span>

<span class="comment">// Proper cleanup prevents memory leaks</span>
<span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="method">OnServiceShutdown</span><span class="punctuation">()</span>
<span class="punctuation">{</span>
    <span class="comment">// Unsubscribe from all events</span>
    <span class="class-name">InputActionMappings</span><span class="punctuation">.</span>OnPlayerActionTriggered <span class="operator">-=</span> <span class="method">HandlePlayerAction</span><span class="punctuation">;</span>
    <span class="class-name">InputActionMappings</span><span class="punctuation">.</span>OnUIActionTriggered <span class="operator">-=</span> <span class="method">HandleUIAction</span><span class="punctuation">;</span>
    
    <span class="comment">// Clear collections</span>
    <span class="punctuation">_</span>activeContexts<span class="punctuation">.</span><span class="method">Clear</span><span class="punctuation">();</span>
    <span class="punctuation">_</span>sortedContexts<span class="punctuation">.</span><span class="method">Clear</span><span class="punctuation">();</span>
    
    <span class="comment">// Dispose Unity objects</span>
    <span class="punctuation">_</span>inputActions<span class="operator">?.</span><span class="method">Dispose</span><span class="punctuation">();</span>
<span class="punctuation">}</span></pre>

            <h3>Health Monitoring</h3>
            <p>Built-in service health monitoring with detailed metrics:</p>
            <div class="code-block">
<pre><span class="keyword">public</span> <span class="keyword">async</span> <span class="class-name">UniTask</span><span class="operator">&lt;</span><span class="class-name">ServiceHealthStatus</span><span class="operator">&gt;</span> <span class="method">GetHealthAsync</span><span class="punctuation">()</span>
<span class="punctuation">{</span>
    <span class="comment">// Check input system status</span>
    <span class="keyword">var</span> playerActionsEnabled <span class="operator">=</span> <span class="punctuation">_</span>inputActions<span class="punctuation">.</span>Player<span class="punctuation">.</span>enabled<span class="punctuation">;</span>
    <span class="keyword">var</span> uiActionsEnabled <span class="operator">=</span> <span class="punctuation">_</span>inputActions<span class="punctuation">.</span>UI<span class="punctuation">.</span>enabled<span class="punctuation">;</span>
    
    <span class="keyword">return</span> <span class="class-name">ServiceHealthStatus</span><span class="punctuation">.</span><span class="method">Healthy</span><span class="punctuation">(</span><span class="string">"InputService functioning normally"</span><span class="punctuation">)</span>
        <span class="punctuation">.</span><span class="method">WithDetail</span><span class="punctuation">(</span><span class="string">"ActiveContextsCount"</span><span class="punctuation">,</span> <span class="punctuation">_</span>activeContexts<span class="punctuation">.</span>Count<span class="punctuation">)</span>
        <span class="punctuation">.</span><span class="method">WithDetail</span><span class="punctuation">(</span><span class="string">"HighestPriorityLayer"</span><span class="punctuation">,</span> <span class="method">GetTopLayerName</span><span class="punctuation">())</span>
        <span class="punctuation">.</span><span class="method">WithDetail</span><span class="punctuation">(</span><span class="string">"PlayerActionsEnabled"</span><span class="punctuation">,</span> playerActionsEnabled<span class="punctuation">)</span>
        <span class="punctuation">.</span><span class="method">WithDetail</span><span class="punctuation">(</span><span class="string">"UIActionsEnabled"</span><span class="punctuation">,</span> uiActionsEnabled<span class="punctuation">)</span>
        <span class="punctuation">.</span><span class="method">WithDetail</span><span class="punctuation">(</span><span class="string">"CurrentDevice"</span><span class="punctuation">,</span> <span class="punctuation">_</span>deviceTracker<span class="punctuation">.</span>CurrentDeviceType<span class="punctuation">)</span>
        <span class="punctuation">.</span><span class="method">WithDetail</span><span class="punctuation">(</span><span class="string">"DetailedLogging"</span><span class="punctuation">,</span> <span class="punctuation">_</span>config<span class="punctuation">.</span>EnableDetailedLogging<span class="punctuation">);</span>
<span class="punctuation">}</span></pre>

            <h3>Cross-Service Integration</h3>
            <p>Deep integration with other Engine services:</p>
            <div class="code-block">
<pre><span class="comment">// SaveLoadService integration</span>
<span class="keyword">public</span> <span class="keyword">async</span> <span class="class-name">UniTask</span><span class="operator">&lt;</span><span class="keyword">bool</span><span class="operator">&gt;</span> <span class="method">SaveBindingsAsync</span><span class="punctuation">()</span>
<span class="punctuation">{</span>
    <span class="keyword">var</span> bindings <span class="operator">=</span> <span class="punctuation">_</span>inputActions<span class="punctuation">.</span><span class="method">SaveBindingOverridesAsJson</span><span class="punctuation">();</span>
    <span class="keyword">return</span> <span class="keyword">await</span> <span class="punctuation">_</span>persistence<span class="punctuation">.</span><span class="method">SaveCurrentBindingsAsync</span><span class="punctuation">(</span>bindings<span class="punctuation">);</span>
<span class="punctuation">}</span>

<span class="comment">// RuntimeData integration for cross-service visibility</span>
<span class="keyword">private</span> <span class="keyword">void</span> <span class="method">SaveBindings</span><span class="punctuation">(</span><span class="class-name">InputBindingsSaveData</span> saveData<span class="punctuation">)</span>
<span class="punctuation">{</span>
    <span class="class-name">RuntimeData</span><span class="punctuation">.</span><span class="method">LoadCustomData</span><span class="punctuation">(</span>saveData<span class="punctuation">);</span>
    <span class="comment">// Other services can now observe binding changes</span>
<span class="punctuation">}</span>

<span class="comment">// AudioService integration (when available)</span>
<span class="keyword">private</span> <span class="keyword">void</span> <span class="method">PlaySound</span><span class="punctuation">(</span><span class="class-name">AudioClip</span> clip<span class="punctuation">)</span>
<span class="punctuation">{</span>
    <span class="comment">// TODO: Integrate with AudioService when available</span>
    <span class="comment">// For now, use fallback AudioSource</span>
<span class="punctuation">}</span></pre>
        </section>

        <!-- Migration Guide Section -->
        <section id="migration" class="section">
            <h2>🔄 Migration from Legacy System</h2>

            <h3>Context System Changes</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Legacy Code</th>
                            <th>Modern Replacement</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <div class="code-block">
<pre>inputService<span class="punctuation">.</span><span class="method">PushContext</span><span class="punctuation">(</span><span class="keyword">new</span> <span class="class-name">InputContext</span> 
<span class="punctuation">{</span>
    Name <span class="operator">=</span> <span class="string">"Dialog"</span><span class="punctuation">,</span>
    BlockAllInput <span class="operator">=</span> <span class="keyword">true</span>
<span class="punctuation">});</span></pre>
                            </td>
                            <td>
                                <div class="code-block">
<pre><span class="keyword">var</span> context <span class="operator">=</span> <span class="class-name">InputContext</span><span class="punctuation">.</span><span class="method">CreateModal</span><span class="punctuation">()</span>
    <span class="punctuation">.</span><span class="method">WithDebugInfo</span><span class="punctuation">(</span><span class="string">"Dialog"</span><span class="punctuation">);</span>
<span class="keyword">using</span> <span class="keyword">var</span> handle <span class="operator">=</span> inputService<span class="punctuation">.</span><span class="method">RegisterContext</span><span class="punctuation">(</span>context<span class="punctuation">);</span></pre>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="code-block">
<pre>inputService<span class="punctuation">.</span><span class="method">PopContext</span><span class="punctuation">(</span><span class="string">"Dialog"</span><span class="punctuation">);</span></pre>
                            </td>
                            <td>
                                <div class="code-block">
<pre>handle<span class="punctuation">.</span><span class="method">Dispose</span><span class="punctuation">();</span> <span class="comment">// or using statement</span></pre>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="code-block">
<pre>inputService<span class="punctuation">.</span><span class="method">SetInputBlocked</span><span class="punctuation">(</span><span class="keyword">true</span><span class="punctuation">);</span></pre>
                            </td>
                            <td>
                                <div class="code-block">
<pre><span class="keyword">var</span> blockContext <span class="operator">=</span> <span class="keyword">new</span> <span class="class-name">InputContext</span><span class="punctuation">(</span><span class="enum">InputLayer</span><span class="punctuation">.</span>System<span class="punctuation">)</span>
    <span class="punctuation">.</span><span class="method">WithPlayerFilter</span><span class="punctuation">(</span><span class="class-name">ActionFilter</span><span class="operator">&lt;</span><span class="enum">PlayerAction</span><span class="operator">&gt;</span><span class="punctuation">.</span><span class="method">AllowOnly</span><span class="punctuation">())</span>
    <span class="punctuation">.</span><span class="method">WithUIFilter</span><span class="punctuation">(</span><span class="class-name">ActionFilter</span><span class="operator">&lt;</span><span class="enum">UIAction</span><span class="operator">&gt;</span><span class="punctuation">.</span><span class="method">AllowOnly</span><span class="punctuation">());</span></pre>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Breaking Changes</h3>
            <div class="api-method priority-high">
                <h4>⚠️ Removed APIs</h4>
                <ul>
                    <li><code>PushContext(InputContext)</code> → Use <code>RegisterContext()</code></li>
                    <li><code>PopContext(string)</code> → Use handle disposal</li>  
                    <li><code>SetInputBlocked(bool)</code> → Use context system</li>
                    <li><code>GetCurrentContext()</code> → Use <code>GetActiveContexts()[0]</code></li>
                    <li><code>OnContextChanged</code> → Use <code>OnContextsChanged</code></li>
                </ul>
            </div>

            <div class="api-method priority-medium">
                <h4>⚠️ Changed Behavior</h4>
                <ul>
                    <li>Contexts now use priority processing instead of stack order</li>
                    <li>Multiple contexts can be active simultaneously</li>
                    <li>Input blocking is per-action-type (PlayerAction vs UIAction)</li>
                    <li>Context names are optional debug info only</li>
                </ul>
            </div>

            <h3>Migration Steps</h3>
            <ol>
                <li><strong>Replace string-based context management:</strong>
                    <div class="code-block">
<pre><span class="comment">// Before</span>
inputService<span class="punctuation">.</span><span class="method">PushContext</span><span class="punctuation">(</span>dialogContext<span class="punctuation">);</span>
<span class="comment">// Later...</span>
inputService<span class="punctuation">.</span><span class="method">PopContext</span><span class="punctuation">(</span><span class="string">"Dialog"</span><span class="punctuation">);</span> <span class="comment">// Error prone!</span>

<span class="comment">// After</span>
<span class="keyword">using</span> <span class="keyword">var</span> handle <span class="operator">=</span> inputService<span class="punctuation">.</span><span class="method">RegisterContext</span><span class="punctuation">(</span>dialogContext<span class="punctuation">);</span>
<span class="comment">// Auto-cleanup, no strings</span></pre>
                </li>

                <li><strong>Update context filtering:</strong>
                    <div class="code-block">
<pre><span class="comment">// Before</span>
context<span class="punctuation">.</span>BlockedPlayerActions <span class="operator">=</span> <span class="keyword">new</span><span class="punctuation">[]</span> <span class="punctuation">{</span> <span class="enum">PlayerAction</span><span class="punctuation">.</span>Move<span class="punctuation">,</span> <span class="enum">PlayerAction</span><span class="punctuation">.</span>Attack <span class="punctuation">};</span>
context<span class="punctuation">.</span>BlockAllInput <span class="operator">=</span> <span class="keyword">false</span><span class="punctuation">;</span>

<span class="comment">// After</span>
context<span class="punctuation">.</span><span class="method">WithPlayerFilter</span><span class="punctuation">(</span><span class="class-name">ActionFilter</span><span class="operator">&lt;</span><span class="enum">PlayerAction</span><span class="operator">&gt;</span><span class="punctuation">.</span><span class="method">BlockExcept</span><span class="punctuation">(</span>
    <span class="enum">PlayerAction</span><span class="punctuation">.</span>Move<span class="punctuation">,</span> <span class="enum">PlayerAction</span><span class="punctuation">.</span>Attack
<span class="punctuation">));</span></pre>
                </li>

                <li><strong>Replace global input blocking:</strong>
                    <div class="code-block">
<pre><span class="comment">// Before</span>
inputService<span class="punctuation">.</span><span class="method">SetInputBlocked</span><span class="punctuation">(</span><span class="keyword">true</span><span class="punctuation">);</span>

<span class="comment">// After</span>
<span class="keyword">var</span> blockContext <span class="operator">=</span> <span class="keyword">new</span> <span class="class-name">InputContext</span><span class="punctuation">(</span><span class="enum">InputLayer</span><span class="punctuation">.</span>Critical<span class="punctuation">)</span>
    <span class="punctuation">.</span><span class="method">WithPlayerFilter</span><span class="punctuation">(</span><span class="class-name">ActionFilter</span><span class="operator">&lt;</span><span class="enum">PlayerAction</span><span class="operator">&gt;</span><span class="punctuation">.</span><span class="method">AllowOnly</span><span class="punctuation">())</span>
    <span class="punctuation">.</span><span class="method">WithUIFilter</span><span class="punctuation">(</span><span class="class-name">ActionFilter</span><span class="operator">&lt;</span><span class="enum">UIAction</span><span class="operator">&gt;</span><span class="punctuation">.</span><span class="method">AllowOnly</span><span class="punctuation">());</span>
<span class="keyword">using</span> <span class="keyword">var</span> handle <span class="operator">=</span> inputService<span class="punctuation">.</span><span class="method">RegisterContext</span><span class="punctuation">(</span>blockContext<span class="punctuation">);</span></pre>
                </li>

                <li><strong>Update event handlers:</strong>
                    <div class="code-block">
<pre><span class="comment">// Before</span>
inputService<span class="punctuation">.</span>OnContextChanged <span class="operator">+=</span> <span class="punctuation">(</span>context<span class="punctuation">)</span> <span class="operator">=&gt;</span> <span class="method">UpdateUI</span><span class="punctuation">(</span>context<span class="punctuation">);</span>

<span class="comment">// After</span>
inputService<span class="punctuation">.</span>OnContextsChanged <span class="operator">+=</span> <span class="punctuation">(</span>contexts<span class="punctuation">)</span> <span class="operator">=&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">var</span> topContext <span class="operator">=</span> contexts<span class="punctuation">.</span>Count <span class="operator">&gt;</span> <span class="number">0</span> <span class="operator">?</span> contexts<span class="punctuation">[</span><span class="number">0</span><span class="punctuation">]</span> <span class="operator">:</span> <span class="keyword">null</span><span class="punctuation">;</span>
    <span class="method">UpdateUI</span><span class="punctuation">(</span>topContext<span class="punctuation">);</span>
<span class="punctuation">};</span></pre>
                </li>
            </ol>

            <h3>Compatibility Notes</h3>
            <ul>
                <li>✅ All input query methods unchanged (IsActionPressed, GetVector2Value, etc.)</li>
                <li>✅ Event system unchanged (OnPlayerActionTriggered, OnUIActionTriggered)</li>
                <li>✅ Device detection unchanged (CurrentDeviceType, OnDeviceChanged)</li>
                <li>✅ Configuration properties unchanged</li>
                <li>❌ Context management API completely redesigned</li>
                <li>❌ String-based context identification removed</li>
            </ul>
        </section>

        <!-- Footer -->
        <section class="section">
            <h2>📋 Summary</h2>
            <p>The Sinkii09 Engine InputService provides a <strong>professional-grade input management system</strong> with:</p>

            <div class="feature-grid">
                <div class="feature-card">
                    <h4>✅ Complete Feature Set</h4>
                    <ul>
                        <li>Type-safe input queries</li>
                        <li>Modern context system</li>
                        <li>Runtime rebinding</li>
                        <li>Device auto-switching</li>
                        <li>Configuration-driven behavior</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>🚀 Professional Quality</h4>
                    <ul>
                        <li>AAA game development patterns</li>
                        <li>RAII lifecycle management</li>
                        <li>Zero allocation queries</li>
                        <li>Memory leak prevention</li>
                        <li>Comprehensive debugging</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>🔧 Engine Integration</h4>
                    <ul>
                        <li>SaveLoadService persistence</li>
                        <li>RuntimeData cross-service visibility</li>
                        <li>Service health monitoring</li>
                        <li>Configuration hot-reload</li>
                        <li>Event-driven architecture</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>📚 Developer Friendly</h4>
                    <ul>
                        <li>Fluent API design</li>
                        <li>Rich factory methods</li>
                        <li>Comprehensive documentation</li>
                        <li>Clear migration path</li>
                        <li>Extensive examples</li>
                    </ul>
                </div>
            </div>

            <div class="code-block">
<pre><span class="comment">// 🎯 Ready for Production Use</span>
<span class="comment">// The InputService is feature-complete and ready for use in production games.</span>
<span class="comment">// Future Phase 4 (Accessibility Features) will add additional capabilities</span>
<span class="comment">// without breaking existing APIs.</span>

<span class="comment">// Next Steps:</span>
<span class="comment">// • Implement accessibility features (Hold-to-Press, Input Assistance)</span>
<span class="comment">// • Add combo detection system</span>
<span class="comment">// • Integrate haptic feedback</span>
<span class="comment">// • Performance optimization for mobile platforms</span></pre>

            <hr style="margin: 2rem 0; border: 1px solid var(--border-color);">
            
            <p style="text-align: center; color: var(--text-secondary);">
                <strong>Sinkii09 Engine InputService Documentation</strong><br>
                Generated: January 2025 | Version: 2.0.0<br>
                For questions or issues, refer to the Engine development team
            </p>
        </section>
    </div>
</body>
</html>